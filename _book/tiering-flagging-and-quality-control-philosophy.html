<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Tiering, flagging, and quality control philosophy | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Tiering, flagging, and quality control philosophy | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Tiering, flagging, and quality control philosophy | _main.knit" />
  
  
  

<meta name="author" content="ROSSyndicate" />


<meta name="date" content="2024-04-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="download-process.html"/>
<link rel="next" href="chlorophyll-a-chla-harmonization-process.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> AquaMatch data harmonization process</a></li>
<li class="chapter" data-level="2" data-path="technical-details.html"><a href="technical-details.html"><i class="fa fa-check"></i><b>2</b> Technical details</a></li>
<li class="chapter" data-level="3" data-path="download-process.html"><a href="download-process.html"><i class="fa fa-check"></i><b>3</b> Download process</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="download-process.html"><a href="download-process.html#catalogue-existing-data"><i class="fa fa-check"></i><b>3.0.1</b> Catalogue existing data</a></li>
<li class="chapter" data-level="3.0.2" data-path="download-process.html"><a href="download-process.html#maps-of-data-spread"><i class="fa fa-check"></i><b>3.0.2</b> Maps of data spread</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html"><i class="fa fa-check"></i><b>4</b> Tiering, flagging, and quality control philosophy</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#handling-na-values"><i class="fa fa-check"></i><b>4.1</b> Handling <code>NA</code> values</a></li>
<li class="chapter" data-level="4.2" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#heterogenous-data"><i class="fa fa-check"></i><b>4.2</b> Heterogenous data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#method-tiering"><i class="fa fa-check"></i><b>4.2.1</b> Method tiering</a></li>
<li class="chapter" data-level="4.2.2" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#field-flags"><i class="fa fa-check"></i><b>4.2.2</b> Field flags</a></li>
<li class="chapter" data-level="4.2.3" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#depth-flags"><i class="fa fa-check"></i><b>4.2.3</b> Depth flags</a></li>
<li class="chapter" data-level="4.2.4" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#general-note"><i class="fa fa-check"></i><b>4.2.4</b> General note</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#simultaneous-records"><i class="fa fa-check"></i><b>4.3</b> Simultaneous records</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html"><i class="fa fa-check"></i><b>5</b> Chlorophyll <em>a</em> (chla) harmonization process</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#pre-harmonization-of-the-raw-chlorophyll-wqp-dataset"><i class="fa fa-check"></i><b>5.1</b> Pre-harmonization of the raw chlorophyll WQP dataset</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#missing-results"><i class="fa fa-check"></i><b>5.1.1</b> Missing results</a></li>
<li class="chapter" data-level="5.1.2" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#filter-status"><i class="fa fa-check"></i><b>5.1.2</b> Filter status</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#harmonization-ready-chlorophyll-dataset"><i class="fa fa-check"></i><b>5.2</b> Harmonization-ready chlorophyll dataset</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#filter-for-water-media"><i class="fa fa-check"></i><b>5.2.1</b> Filter for water media</a></li>
<li class="chapter" data-level="5.2.2" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#document-and-remove-fails"><i class="fa fa-check"></i><b>5.2.2</b> Document and remove fails</a></li>
<li class="chapter" data-level="5.2.3" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#clean-mdls"><i class="fa fa-check"></i><b>5.2.3</b> Clean MDLs</a></li>
<li class="chapter" data-level="5.2.4" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#clean-approximate-values"><i class="fa fa-check"></i><b>5.2.4</b> Clean approximate values</a></li>
<li class="chapter" data-level="5.2.5" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#clean-values-with-greater-than-data"><i class="fa fa-check"></i><b>5.2.5</b> Clean values with “greater than” data</a></li>
<li class="chapter" data-level="5.2.6" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#drop-unresolved-na-measurements"><i class="fa fa-check"></i><b>5.2.6</b> Drop unresolved NA measurements</a></li>
<li class="chapter" data-level="5.2.7" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#harmonize-record-units"><i class="fa fa-check"></i><b>5.2.7</b> Harmonize record units</a></li>
<li class="chapter" data-level="5.2.8" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#clean-depth-data"><i class="fa fa-check"></i><b>5.2.8</b> Clean depth data</a></li>
<li class="chapter" data-level="5.2.9" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#filter-and-tier-methods"><i class="fa fa-check"></i><b>5.2.9</b> Filter and tier methods</a></li>
<li class="chapter" data-level="5.2.10" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#flag-based-on-field-methods"><i class="fa fa-check"></i><b>5.2.10</b> Flag based on field methods</a></li>
<li class="chapter" data-level="5.2.11" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#aggregate-simultaneous-records"><i class="fa fa-check"></i><b>5.2.11</b> Aggregate simultaneous records</a></li>
<li class="chapter" data-level="5.2.12" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#harmonized-chlorophyll-a"><i class="fa fa-check"></i><b>5.2.12</b> Harmonized chlorophyll a</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html"><i class="fa fa-check"></i><b>6</b> DOC harmonization process</a>
<ul>
<li class="chapter" data-level="6.1" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#pre-harmonization-of-the-raw-doc-wqp-dataset"><i class="fa fa-check"></i><b>6.1</b> Pre-harmonization of the raw doc WQP dataset</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#missing-results-1"><i class="fa fa-check"></i><b>6.1.1</b> Missing results</a></li>
<li class="chapter" data-level="6.1.2" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#filter-status-1"><i class="fa fa-check"></i><b>6.1.2</b> Filter status</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#harmonization-ready-doc-dataset"><i class="fa fa-check"></i><b>6.2</b> Harmonization-ready DOC dataset</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#filter-media-and-fractions"><i class="fa fa-check"></i><b>6.2.1</b> Filter media and fractions</a></li>
<li class="chapter" data-level="6.2.2" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#document-and-remove-fails-1"><i class="fa fa-check"></i><b>6.2.2</b> Document and remove fails</a></li>
<li class="chapter" data-level="6.2.3" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#clean-mdls-1"><i class="fa fa-check"></i><b>6.2.3</b> Clean MDLs</a></li>
<li class="chapter" data-level="6.2.4" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#clean-approximate-values-1"><i class="fa fa-check"></i><b>6.2.4</b> Clean approximate values</a></li>
<li class="chapter" data-level="6.2.5" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#clean-values-with-greater-than-data-1"><i class="fa fa-check"></i><b>6.2.5</b> Clean values with “greater than” data</a></li>
<li class="chapter" data-level="6.2.6" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#drop-unresolved-na-measurements-1"><i class="fa fa-check"></i><b>6.2.6</b> Drop unresolved NA measurements</a></li>
<li class="chapter" data-level="6.2.7" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#harmonize-record-units-1"><i class="fa fa-check"></i><b>6.2.7</b> Harmonize record units</a></li>
<li class="chapter" data-level="6.2.8" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#clean-depth-data-1"><i class="fa fa-check"></i><b>6.2.8</b> Clean depth data</a></li>
<li class="chapter" data-level="6.2.9" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#filter-and-tier-analytical-methods"><i class="fa fa-check"></i><b>6.2.9</b> Filter and tier analytical methods</a></li>
<li class="chapter" data-level="6.2.10" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#flag-based-on-field-methods-1"><i class="fa fa-check"></i><b>6.2.10</b> Flag based on field methods</a></li>
<li class="chapter" data-level="6.2.11" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#aggregate-simultaneous-records-1"><i class="fa fa-check"></i><b>6.2.11</b> Aggregate simultaneous records</a></li>
<li class="chapter" data-level="6.2.12" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#harmonized-doc"><i class="fa fa-check"></i><b>6.2.12</b> Harmonized DOC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tiering-flagging-and-quality-control-philosophy" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Tiering, flagging, and quality control philosophy<a href="tiering-flagging-and-quality-control-philosophy.html#tiering-flagging-and-quality-control-philosophy" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The variety of data providers, parameters, and methods in the WQP
inevitably results in a heterogenous dataset that requires rigorous
quality control before analytical use. In this chapter, we detail the
general tiering, flagging, and quality control philosophy we apply
across all parameter groups.</p>
<div id="handling-na-values" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Handling <code>NA</code> values<a href="tiering-flagging-and-quality-control-philosophy.html#handling-na-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Columns related directly to the interoperability of data in the WQP,
specifically field and lab methodology and depth-related columns, often
contain many <code>NA</code>s in part due to inconsistent entry across data
providers. A highly restrictive filtering of the WQP that requires
completed data fields would result in very limited data, in part, due to
the prevalence of these <code>NA</code> values. Therefore, we built this pipeline
to resolve as many <code>NA</code>s as possible, but to also include <code>NA</code>s within
an “inclusive” data tier if all columns of interest are not resolvable.
Specifically, we retain <code>NA</code> values if removing those <code>NA</code> records would
drop 10% or more of the available data.</p>
</div>
<div id="heterogenous-data" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Heterogenous data<a href="tiering-flagging-and-quality-control-philosophy.html#heterogenous-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In addition to <code>NA</code> values, WQP entries can be heterogenous for reasons
such as:</p>
<ul>
<li>Having a variety of analytical methods with different levels of
precision and accuracy that are used to quantify the same parameter</li>
<li>Having a variety of sampling methods used to acquire the same
parameter with varying levels of interoperability</li>
<li>Having a variety of names or descriptions that represent the same
analytical or sampling method across different organizations</li>
<li>Having information relevant to assessing data reliability or method
choice spread across multiple columns
<ul>
<li>Containing observations with sample collection methods and
analytical methods that are incompatible</li>
<li>Having data with differing levels of meta data</li>
</ul></li>
</ul>
<p>In order to control for some of this variation and provide end-users
with something more readily navigable we have incorporated several tiers
and flagging systems into the AquaSat v2 dataset:</p>
<ul>
<li><strong>Method tiering</strong>: Tiers indicating the interoperability of data
based on the method used to acquire measurements</li>
<li><strong>Field flags</strong>: Flags indicating whether the sample collection method
is consistent with the analytical method</li>
<li><strong>Depth flags</strong>: Flags indicating the type of water sampling depth
measurement or completeness of the measurement</li>
</ul>
<div id="method-tiering" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Method tiering<a href="tiering-flagging-and-quality-control-philosophy.html#method-tiering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>ResultAnalyticalMethod.MethodName</code> column from the WQP is often the
primary column we use for determining which tier each record falls
within. Details on how each parameter’s methods were sorted into tiers
can be found in its corresponding harmonization chapter.</p>
<p>The primary purpose of our tiering is to determine the reliability and
accuracy of each analytical method across data providers and throughout
time for each parameter in the AquaSat v2 dataset. We developed the
following categories, which are represented in the <code>tier</code> column of the
final dataset:</p>
<ul>
<li><strong>Tier 0: Restrictive.</strong> Data that are verifiably self-similar across
organizations and time-periods and can be considered highly reliable
and interoperable</li>
<li><strong>Tier 1: Narrowed.</strong> Data that we have good reason to believe are
self-similar, but for which we can’t verify full interoperability
across data providers</li>
<li><strong>Tier 2: Inclusive.</strong> Data that are assumed to be reliable and are
harmonized to our best ability given the information available from
the data provider. This tier includes <code>NA</code> or non-resolvable
descriptions for the analytical method, which often make up the
majority of method descriptions for any given parameter. Because this
tier represents many analytical methods, direct interoperability
between samples is not guaranteed.</li>
</ul>
</div>
<div id="field-flags" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Field flags<a href="tiering-flagging-and-quality-control-philosophy.html#field-flags" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>field_flag</code> column is used to check if the sample collection method
(<code>SampleCollectionMethod.MethodName</code>) is reasonable (flag = 0), suspect
(flag = 1), or inconclusive (flag = 2). “Reasonable” flags mean that the
sample collection method and the analytical method or tier are in
harmony with one another. “Suspect” flags are assigned when the sample
collection method description isn’t consistent with what would be
expected given the <code>characteristicName</code> and the
<code>ResultAnalyticalMethod.MethodName</code> for a given record. “Inconclusive”
or unknown flags are assigned to records with “inclusive” tiers because
these tiers include values such as <code>NA</code>, where it’s typically impossible
to determine the appropriateness of a collection method for the sample
record. The relationship between field flags and tiers will vary by
parameter; thus, each harmonization chapter contains specific
information for these different cases.</p>
</div>
<div id="depth-flags" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Depth flags<a href="tiering-flagging-and-quality-control-philosophy.html#depth-flags" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are four columns that explicitly contain depth information for a
given WQP entry, all of which contain a variety of measurement units.
Below is a list of the four columns and their definitions according to
the <a href="https://rconnect.usgs.gov/dataRetrieval/reference/readWQPqw.html">{dataRetrieval} package
documentation</a>.</p>
<ol style="list-style-type: decimal">
<li><code>ActivityDepthHeightMeasure.MeasureValue</code>: “A measurement of the
vertical location (measured from a reference point) at which an
activity occurred.”</li>
<li><code>ResultDepthHeightMeasure.MeasureValue</code>: “A measurement of the
vertical location (measured from a reference point) at which a
result occurred.” <em>Only in STORET</em></li>
<li><code>ActivityTopDepthHeightMeasure.MeasureValue</code>: “A measurement of the
upper vertical location of a vertical location range (measured from
a reference point) at which an activity occurred.”</li>
<li><code>ActivityBottomDepthHeightMeasure.MeasureValue</code>: “A measurement of
the lower vertical location of a vertical location range (measured
from a reference point) at which an activity occurred.”</li>
</ol>
<p>Each of the above columns has a corresponding column containing the <a href="https://rconnect.usgs.gov/dataRetrieval/reference/readWQPqw.html">the
associated unit used in measuring the
item</a>:</p>
<ol style="list-style-type: decimal">
<li><code>ActivityDepthHeightMeasure.MeasureUnitCode</code></li>
<li><code>ResultDepthHeightMeasure.MeasureUnitCode</code></li>
<li><code>ActivityTopDepthHeightMeasure.MeasureUnitCode</code></li>
<li><code>ActivityBottomDepthHeightMeasure.MeasureUnitCode</code></li>
</ol>
<div id="pre-processing" class="section level4 hasAnchor" number="4.2.3.1">
<h4><span class="header-section-number">4.2.3.1</span> Pre-processing<a href="tiering-flagging-and-quality-control-philosophy.html#pre-processing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Prior to assigning the <code>depth_flag</code> we complete a few pre-processing
steps:</p>
<ol style="list-style-type: decimal">
<li>Convert the following character values to an explicit <code>NA</code>: “NA”,
“999”, “-999”, “9999”, “-9999”, “-99”, “99”, “NaN”</li>
<li>Convert depths in all four columns to meters from the depth unit
listed by the data provider</li>
<li>Create a single “discrete” sample depth column using a combination
of the <code>ActivityDepthHeightMeasure.MeasureValue</code> and
<code>ResultDepthHeightMeasure.MeasureValue</code> columns. We use
<code>ActivityDepth</code> value when <code>ResultDepth</code> value is missing, and
<code>ResultDepth</code> when <code>ActivityDepth</code> is missing. If both columns have
values but disagree we use an average of the two.</li>
</ol>
<p>This pre-processing results in three “harmonized” columns reporting
water sampling depth values in meters:
<code>harmonized_discrete_depth_value</code>, <code>harmonized_top_depth_value</code>,
<code>harmonized_bottom_depth_value</code>.</p>
<p>Sample depth flags are assigned using the harmonized depth columns that
result from the pre-processing steps above. If the record has no depth
listed it is assigned a <code>depth_flag</code> of 0. A record with only discrete
depth listed in the <code>harmonized_discrete_depth_value</code> is given a
<code>depth_flag</code> of 1. A record with top and/or bottom depth
(<code>harmonized_top_depth_value</code>, <code>harmonized_bottom_depth_value</code>),
indicating an integrated sample, is assigned a <code>depth_flag</code> of 2, and
any combination of discrete + top and/or bottom depths is assigned a
<code>depth_flag</code> of 3, since the sample depth(s) can not be reconciled with
certainty.</p>
</div>
</div>
<div id="general-note" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> General note<a href="tiering-flagging-and-quality-control-philosophy.html#general-note" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Generally speaking, we avoid further classification for any WQP entry’s
parameter methodology, tier, or flag unless there are at least 1% of
observations with the same unresolved text.</p>
</div>
</div>
<div id="simultaneous-records" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Simultaneous records<a href="tiering-flagging-and-quality-control-philosophy.html#simultaneous-records" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The WQP contains records that can be considered true duplicates and
others where multiple non-identical measurements are recorded at the
same time, place, and depth by the same organization. We deal with these
within each parameter’s harmonization step by taking the median value
from simultaneous observations. We also report the standard deviation
and the total number of entries contributing to the median in the
<code>harmonized_value_sd</code> and <code>harmonized_row_count</code> columns of the final
dataset.</p>
<p>This record aggregation is dealt with separately for each parameter so
that specific accommodations can be made based on their tiering and
value cleaning processes. Additionally, this step also requires us to
group the dataset by a subset of its original columns, necessarily
resulting in a reduced subset of columns in the final data product. To
aid in back-joining for advanced AquaSat users, we provide a
<code>subgroup_id</code> column identifying the grouping used to create the
aggregated median and standard deviation values. The <code>subgroup_id</code> is
also present in an upstream, pre-aggregated dataset version that
contains all records prior to aggregation and the original WQP columns
along with the columns created in the harmonization steps. The upstream,
pre-aggregated dadtaset is the <code>p3_chla_preagg_grouped</code> pipeline target.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="download-process.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chlorophyll-a-chla-harmonization-process.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
