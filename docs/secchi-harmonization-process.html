<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Secchi harmonization process | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Secchi harmonization process | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Secchi harmonization process | _main.knit" />
  
  
  

<meta name="author" content="ROSSyndicate" />


<meta name="date" content="2024-09-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="doc-harmonization-process.html"/>
<link rel="next" href="notes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> AquaMatch data harmonization process</a></li>
<li class="chapter" data-level="2" data-path="technical-details.html"><a href="technical-details.html"><i class="fa fa-check"></i><b>2</b> Technical details</a></li>
<li class="chapter" data-level="3" data-path="download-process.html"><a href="download-process.html"><i class="fa fa-check"></i><b>3</b> Download process</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="download-process.html"><a href="download-process.html#catalogue-existing-data"><i class="fa fa-check"></i><b>3.0.1</b> Catalogue existing data</a></li>
<li class="chapter" data-level="3.0.2" data-path="download-process.html"><a href="download-process.html#maps-of-data-spread"><i class="fa fa-check"></i><b>3.0.2</b> Maps of data spread</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html"><i class="fa fa-check"></i><b>4</b> Tiering, flagging, and quality control philosophy</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#handling-na-values"><i class="fa fa-check"></i><b>4.1</b> Handling <code>NA</code> values</a></li>
<li class="chapter" data-level="4.2" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#heterogenous-data"><i class="fa fa-check"></i><b>4.2</b> Heterogenous data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#method-tiering"><i class="fa fa-check"></i><b>4.2.1</b> Method tiering</a></li>
<li class="chapter" data-level="4.2.2" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#field-flags"><i class="fa fa-check"></i><b>4.2.2</b> Field flags</a></li>
<li class="chapter" data-level="4.2.3" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#depth-flags"><i class="fa fa-check"></i><b>4.2.3</b> Depth flags</a></li>
<li class="chapter" data-level="4.2.4" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#miscellaneous-flags"><i class="fa fa-check"></i><b>4.2.4</b> Miscellaneous flags</a></li>
<li class="chapter" data-level="4.2.5" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#time-and-date-handling"><i class="fa fa-check"></i><b>4.2.5</b> Time and date handling</a></li>
<li class="chapter" data-level="4.2.6" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#anonymization"><i class="fa fa-check"></i><b>4.2.6</b> Anonymization</a></li>
<li class="chapter" data-level="4.2.7" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#general-notes"><i class="fa fa-check"></i><b>4.2.7</b> General notes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tiering-flagging-and-quality-control-philosophy.html"><a href="tiering-flagging-and-quality-control-philosophy.html#simultaneous-records"><i class="fa fa-check"></i><b>4.3</b> Simultaneous records</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html"><i class="fa fa-check"></i><b>5</b> Chlorophyll <em>a</em> (chla) harmonization process</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#pre-harmonization-of-the-raw-chlorophyll-wqp-dataset"><i class="fa fa-check"></i><b>5.1</b> Pre-harmonization of the raw chlorophyll WQP dataset</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#missing-results"><i class="fa fa-check"></i><b>5.1.1</b> Missing results</a></li>
<li class="chapter" data-level="5.1.2" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#filter-status"><i class="fa fa-check"></i><b>5.1.2</b> Filter status</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#harmonization-ready-chlorophyll-dataset"><i class="fa fa-check"></i><b>5.2</b> Harmonization-ready chlorophyll dataset</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#filter-for-water-media"><i class="fa fa-check"></i><b>5.2.1</b> Filter for water media</a></li>
<li class="chapter" data-level="5.2.2" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#document-and-remove-fails"><i class="fa fa-check"></i><b>5.2.2</b> Document and remove fails</a></li>
<li class="chapter" data-level="5.2.3" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#clean-mdls"><i class="fa fa-check"></i><b>5.2.3</b> Clean MDLs</a></li>
<li class="chapter" data-level="5.2.4" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#clean-approximate-values"><i class="fa fa-check"></i><b>5.2.4</b> Clean approximate values</a></li>
<li class="chapter" data-level="5.2.5" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#clean-values-with-greater-than-data"><i class="fa fa-check"></i><b>5.2.5</b> Clean values with “greater than” data</a></li>
<li class="chapter" data-level="5.2.6" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#drop-unresolved-na-measurements"><i class="fa fa-check"></i><b>5.2.6</b> Drop unresolved NA measurements</a></li>
<li class="chapter" data-level="5.2.7" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#harmonize-record-units"><i class="fa fa-check"></i><b>5.2.7</b> Harmonize record units</a></li>
<li class="chapter" data-level="5.2.8" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#clean-depth-data"><i class="fa fa-check"></i><b>5.2.8</b> Clean depth data</a></li>
<li class="chapter" data-level="5.2.9" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#filter-and-tier-methods"><i class="fa fa-check"></i><b>5.2.9</b> Filter and tier methods</a></li>
<li class="chapter" data-level="5.2.10" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#flag-based-on-field-methods"><i class="fa fa-check"></i><b>5.2.10</b> Flag based on field methods</a></li>
<li class="chapter" data-level="5.2.11" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#miscellaneous-flag"><i class="fa fa-check"></i><b>5.2.11</b> Miscellaneous flag</a></li>
<li class="chapter" data-level="5.2.12" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#remove-unrealistic-values"><i class="fa fa-check"></i><b>5.2.12</b> Remove unrealistic values</a></li>
<li class="chapter" data-level="5.2.13" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#aggregate-simultaneous-records"><i class="fa fa-check"></i><b>5.2.13</b> Aggregate simultaneous records</a></li>
<li class="chapter" data-level="5.2.14" data-path="chlorophyll-a-chla-harmonization-process.html"><a href="chlorophyll-a-chla-harmonization-process.html#harmonized-chlorophyll-a"><i class="fa fa-check"></i><b>5.2.14</b> Harmonized chlorophyll a</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html"><i class="fa fa-check"></i><b>6</b> DOC harmonization process</a>
<ul>
<li class="chapter" data-level="6.1" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#pre-harmonization-of-the-raw-doc-wqp-dataset"><i class="fa fa-check"></i><b>6.1</b> Pre-harmonization of the raw doc WQP dataset</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#missing-results-1"><i class="fa fa-check"></i><b>6.1.1</b> Missing results</a></li>
<li class="chapter" data-level="6.1.2" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#filter-status-1"><i class="fa fa-check"></i><b>6.1.2</b> Filter status</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#harmonization-ready-doc-dataset"><i class="fa fa-check"></i><b>6.2</b> Harmonization-ready DOC dataset</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#filter-media-and-fractions"><i class="fa fa-check"></i><b>6.2.1</b> Filter media and fractions</a></li>
<li class="chapter" data-level="6.2.2" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#document-and-remove-fails-1"><i class="fa fa-check"></i><b>6.2.2</b> Document and remove fails</a></li>
<li class="chapter" data-level="6.2.3" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#clean-mdls-1"><i class="fa fa-check"></i><b>6.2.3</b> Clean MDLs</a></li>
<li class="chapter" data-level="6.2.4" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#clean-approximate-values-1"><i class="fa fa-check"></i><b>6.2.4</b> Clean approximate values</a></li>
<li class="chapter" data-level="6.2.5" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#clean-values-with-greater-than-data-1"><i class="fa fa-check"></i><b>6.2.5</b> Clean values with “greater than” data</a></li>
<li class="chapter" data-level="6.2.6" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#drop-unresolved-na-measurements-1"><i class="fa fa-check"></i><b>6.2.6</b> Drop unresolved NA measurements</a></li>
<li class="chapter" data-level="6.2.7" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#harmonize-record-units-1"><i class="fa fa-check"></i><b>6.2.7</b> Harmonize record units</a></li>
<li class="chapter" data-level="6.2.8" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#clean-depth-data-1"><i class="fa fa-check"></i><b>6.2.8</b> Clean depth data</a></li>
<li class="chapter" data-level="6.2.9" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#filter-and-tier-analytical-methods"><i class="fa fa-check"></i><b>6.2.9</b> Filter and tier analytical methods</a></li>
<li class="chapter" data-level="6.2.10" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#flag-based-on-field-methods-1"><i class="fa fa-check"></i><b>6.2.10</b> Flag based on field methods</a></li>
<li class="chapter" data-level="6.2.11" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#aggregate-simultaneous-records-1"><i class="fa fa-check"></i><b>6.2.11</b> Aggregate simultaneous records</a></li>
<li class="chapter" data-level="6.2.12" data-path="doc-harmonization-process.html"><a href="doc-harmonization-process.html#harmonized-doc"><i class="fa fa-check"></i><b>6.2.12</b> Harmonized DOC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html"><i class="fa fa-check"></i><b>7</b> Secchi harmonization process</a>
<ul>
<li class="chapter" data-level="7.1" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#pre-harmonization-of-the-raw-secchi-wqp-dataset"><i class="fa fa-check"></i><b>7.1</b> Pre-harmonization of the raw Secchi WQP dataset</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#missing-results-2"><i class="fa fa-check"></i><b>7.1.1</b> Missing results</a></li>
<li class="chapter" data-level="7.1.2" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#filter-status-2"><i class="fa fa-check"></i><b>7.1.2</b> Filter Status</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#harmonization-ready-secchi-dataset"><i class="fa fa-check"></i><b>7.2</b> Harmonization-ready Secchi dataset</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#filter-for-water-media-1"><i class="fa fa-check"></i><b>7.2.1</b> Filter for water media</a></li>
<li class="chapter" data-level="7.2.2" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#document-and-remove-fails-2"><i class="fa fa-check"></i><b>7.2.2</b> Document and remove fails</a></li>
<li class="chapter" data-level="7.2.3" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#clean-special-characters"><i class="fa fa-check"></i><b>7.2.3</b> Clean special characters</a></li>
<li class="chapter" data-level="7.2.4" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#clean-values-with-less-than-data"><i class="fa fa-check"></i><b>7.2.4</b> Clean values with “less than” data</a></li>
<li class="chapter" data-level="7.2.5" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#clean-values-with-greater-than-data-2"><i class="fa fa-check"></i><b>7.2.5</b> Clean values with “greater than” data</a></li>
<li class="chapter" data-level="7.2.6" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#gap-filling-harmonized-values"><i class="fa fa-check"></i><b>7.2.6</b> Gap filling harmonized values</a></li>
<li class="chapter" data-level="7.2.7" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#drop-unresolved-na-measurements-2"><i class="fa fa-check"></i><b>7.2.7</b> Drop unresolved NA measurements</a></li>
<li class="chapter" data-level="7.2.8" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#harmonize-record-units-2"><i class="fa fa-check"></i><b>7.2.8</b> Harmonize record units</a></li>
<li class="chapter" data-level="7.2.9" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#clean-and-flag-bottom-depth-data"><i class="fa fa-check"></i><b>7.2.9</b> Clean and flag bottom depth data</a></li>
<li class="chapter" data-level="7.2.10" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#filter-methods"><i class="fa fa-check"></i><b>7.2.10</b> Filter methods</a></li>
<li class="chapter" data-level="7.2.11" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#tier-methods"><i class="fa fa-check"></i><b>7.2.11</b> Tier methods</a></li>
<li class="chapter" data-level="7.2.12" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#flag"><i class="fa fa-check"></i><b>7.2.12</b> Flag</a></li>
<li class="chapter" data-level="7.2.13" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#remove-unrealistic-values-1"><i class="fa fa-check"></i><b>7.2.13</b> Remove unrealistic values</a></li>
<li class="chapter" data-level="7.2.14" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#aggregate-simultaneous-records-2"><i class="fa fa-check"></i><b>7.2.14</b> Aggregate simultaneous records</a></li>
<li class="chapter" data-level="7.2.15" data-path="secchi-harmonization-process.html"><a href="secchi-harmonization-process.html#harmonized-secchi-disk-depth"><i class="fa fa-check"></i><b>7.2.15</b> Harmonized Secchi disk depth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>8</b> Notes</a></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="secchi-harmonization-process" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Secchi harmonization process<a href="secchi-harmonization-process.html#secchi-harmonization-process" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Following the completion of the {dataRetrieval} download process
described previously, the pipeline contains raw WQP data for each
parameter of interest. Before we harmonize each parameter we run through
a series of universal “pre-harmonization” steps, which ensure that the
datasets are appropriately formatted when entering their harmonization
routines.</p>
<p>The text below first walks through the pre-harmonization steps for the
raw Secchi disk depth dataset and then delves into the specifics of the
harmonization process.</p>
<div id="pre-harmonization-of-the-raw-secchi-wqp-dataset" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Pre-harmonization of the raw Secchi WQP dataset<a href="secchi-harmonization-process.html#pre-harmonization-of-the-raw-secchi-wqp-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the start of the pre-harmonization process the raw Secchi disk depth
WQP dataset contains 3.1 million rows.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-4-1.png" /><!-- --></p>
<p><br></p>
<div id="missing-results-2" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Missing results<a href="secchi-harmonization-process.html#missing-results-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, records that have missing data are dropped from the dataset.
Several criteria are used when checking for missing data. If any of the
below criteria are met the row is flagged as missing:</p>
<ol style="list-style-type: decimal">
<li>Both the result column and detection limit column had <code>NA</code> data</li>
<li>Result, result unit, activity comment, laboratory comment, and
result comment columns are all <code>NA</code></li>
<li>The result comment column contains any user-provided text indicating
a missing value, currently including: <code>analysis lost</code>,
<code>not analyzed</code>, <code>not recorded</code>, <code>not collected</code>, or
<code>no measurement taken</code></li>
</ol>
<p>0.7 thousand rows are dropped, resulting in a final count of 3.1
million.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-6-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="filter-status-2" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Filter Status<a href="secchi-harmonization-process.html#filter-status-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The final step in pre-harmonization is to filter the
<code>ResultStatusIdentifier</code> column to include only the following statuses:</p>
<ul>
<li><code>"Accepted"</code></li>
<li><code>"Final"</code></li>
<li><code>"Historical"</code></li>
<li><code>"Validated"</code></li>
<li><code>"Preliminary"</code></li>
<li><code>NA</code></li>
</ul>
<p>These statuses generally indicate a reliable result having been reached,
however we also include <code>NA</code> in an effort to be conservative. More
specifically, when making decisions for this and other columns we
occasionally retain <code>NA</code> values if removing the records would otherwise
drop 10% or more of the available data.</p>
<p>This step removes 9.2 thousand rows of data, leaving it with 3.1 million
rows remaining.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-8-1.png" /><!-- --></p>
<p><br></p>
</div>
</div>
<div id="harmonization-ready-secchi-dataset" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Harmonization-ready Secchi dataset<a href="secchi-harmonization-process.html#harmonization-ready-secchi-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once ready for harmonization, the Secchi-only dataset contains the
following user-defined <code>characteristicNames</code>: Depth, Secchi disk depth,
Depth, Secchi disk depth (choice list), Secchi Reading Condition (choice
list), Secchi depth, Water transparency, Secchi disc.</p>
<p>These names are chosen in order to select for only those measurements
that pertain to Secchi disk depth measurements.</p>
<p><br></p>
<div id="filter-for-water-media-1" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Filter for water media<a href="secchi-harmonization-process.html#filter-for-water-media-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We next ensure that the media type for all SDD data is
<code>"Surface Water"</code>, <code>"Water"</code>, <code>"Estuary"</code>, or <code>NA</code>. 2075 rows are
removed. The final row count after this is 3.1 million.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-10-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="document-and-remove-fails-2" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Document and remove fails<a href="secchi-harmonization-process.html#document-and-remove-fails-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this step we filter out records based on indications that they have
failed data quality assurance or quality control for some reason given
by the data provider (these instances are referred to here as
“failures”).</p>
<p>After reviewing the contents of the <code>ResultCommentText</code>,
<code>ResultMeasureValue_original</code> (an unedited duplicate of the
<code>ResultMeasureValue</code> field), and <code>ResultDetectionConditionText</code> columns,
we developed a list of terms that captured the majority of instances
where records had failures or unacceptable measurements. We found the
phrasing to be consistent across columns and so we searched for the same
(case agnostic) terms in all four locations. The terms are: “error”,
“fail”, “invalid”, “no result”, “questionable”, “suspect”, “unable”,
“reject”, “no data”, “Not Reported”, “no reading”, “-99”, “upper
quantitation limit”.</p>
<p>Below are pie charts that break down the number of failure detections by
column. Note that the plotting below is automated so if one or more of
the columns listed above are not plotted, this indicates that the
column(s) did not return any matches for the failure phrases. Also note
that a single record can contain multiple failure phrases; therefore,
failure phrases are not mutually exclusive.</p>
<p><br></p>
<div id="resultcommenttext-fail-detects-2" class="section level4 hasAnchor" number="7.2.2.1">
<h4><span class="header-section-number">7.2.2.1</span> ResultCommentText fail detects<a href="secchi-harmonization-process.html#resultcommenttext-fail-detects-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="3_harmonize/out/sdd_ResultCommentText_fail_pie.png" alt="ResultCommentText failure detects" width="650"/></p>
</div>
<div id="resultdetectionconditiontext-fail-detects" class="section level4 hasAnchor" number="7.2.2.2">
<h4><span class="header-section-number">7.2.2.2</span> ResultDetectionConditionText fail detects<a href="secchi-harmonization-process.html#resultdetectionconditiontext-fail-detects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="3_harmonize/out/sdd_ResultDetectionConditionText_fail_pie.png" alt="ResultDetectionConditionText failure detects" width="650"/></p>
</div>
<div id="resultmeasurevalue_original-fail-detects" class="section level4 hasAnchor" number="7.2.2.3">
<h4><span class="header-section-number">7.2.2.3</span> ResultMeasureValue_original fail detects<a href="secchi-harmonization-process.html#resultmeasurevalue_original-fail-detects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="3_harmonize/out/sdd_ResultMeasureValue_original_fail_pie.png" alt="ResultMeasureValue_original failure detects" width="650"/></p>
<p><br></p>
<p>9.8 thousand rows are removed after detecting failure-related phrases
and 3.1 million rows remain.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-12-1.png" /><!-- --></p>
<p><br></p>
</div>
</div>
<div id="clean-special-characters" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Clean special characters<a href="secchi-harmonization-process.html#clean-special-characters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We next address the issue of special characters in the Secchi disk depth
measurements. Some entries in the dataset contain special characters at
the beginning of the measurement value, which need to be removed for
proper numerical analysis. We do this by first identifying measurements
with the special characters <code>-</code>, <code>*</code>, or <code>=</code>. Then we remove those
special characters and convert the values to numeric values and note
which records were modified.</p>
<p>This should not result in a change in rows but we still check: 0 rows
are removed and 3.1 million rows remain.
<img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-14-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="clean-values-with-less-than-data" class="section level3 hasAnchor" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Clean values with “less than” data<a href="secchi-harmonization-process.html#clean-values-with-less-than-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this step, we find and clean records containing <code>&lt;</code> symbols. We first
identify records where the numeric value is missing (<code>NA</code>) in the
<code>ResultMeasureValue</code> column. We then look for the presence of a <code>&lt;</code>
symbol followed by a number in the <code>ResultMeasureValue_original</code> column.
If these conditions are met and there are no alphabetical characters in
the original value, we extract the numeric value after the <code>&lt;</code> symbol.
This extracted value is then used as the harmonized value for the
measurement.</p>
<p>This step is one component of the rules defining our <code>mdl_flag</code> column,
so it is labeled here as “Clean MDLs” (“MDL” = Method detection limit).</p>
<p>This should not result in a change in rows but we still check: 0 rows
are removed and 3.1 million rows remain.
<img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-16-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="clean-values-with-greater-than-data-2" class="section level3 hasAnchor" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Clean values with “greater than” data<a href="secchi-harmonization-process.html#clean-values-with-greater-than-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We next proceed to clean up values reported as “greater than” a certain
measurement. This is similar to the proceeding step of cleaning up “less
than” data.</p>
<p>The <code>ResultMeasureValue</code> column was checked for all three of the
following conditions:</p>
<ol style="list-style-type: decimal">
<li>Numeric-only version of the column was still <code>NA</code> after “&lt;” removal</li>
<li>The original column text contained a number</li>
<li>The original column text contained a “&gt;”</li>
<li>The original column text did not have any letters in it</li>
</ol>
<p>We then used the numeric value (without “&gt;”) as the record’s
<code>harmonized_value</code> moving forward.</p>
<p>This should not result in a change in rows but we still check: 0 rows
are removed and 3.1 million rows remain.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-18-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="gap-filling-harmonized-values" class="section level3 hasAnchor" number="7.2.6">
<h3><span class="header-section-number">7.2.6</span> Gap filling harmonized values<a href="secchi-harmonization-process.html#gap-filling-harmonized-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After cleaning up the “greater than” values, we proceed to fill missing
values in the <code>harmonized_value</code> column using Secchi disk depth
information present in <code>ActivityBottomDepthHeightMeasure.MeasureValue</code>,
<code>ActivityDepthHeightMeasure.MeasureValue</code>, and their corresponding units
columns.</p>
<p>In order to gap-fill the harmonized_value column from the
ActivityBottomDepthHeightMeasure we required both “bottom text” and no
“negate text” to be present and for ActivityDepthHeightMeasure we
required no “bottom text” present but instances of “negate text” was
okay. “Bottom text” was defined as when the <code>ActivityCommentText</code>,
<code>ResultCommentText</code>, and <code>ResultMeasureValue</code> columns contained language
that referenced the “bottom” of the water body. Mentions of “bottom”
alone were taken as a positive indicator that sampling hit the bottom,
while the following other strings were used to negate such indication
(“negate text”): “no bottom”, “not.<em>bottom”, ”couldn’t.</em>bottom”, “could
not.<em>bottom”, ”unable to.</em>bottom”, “too deep”, “too shallow”, “doesn’t
reach”, “did not reach”, “blocked”, “hidden”, “disappeared”, “hose
frozen”, “pump frozen”, “cable not long enough”, “cord not long enough”,
“won’t stay on bottom”, “current too strong”, “too windy”, “fast
current”, “flooding”, “readings not on bottom”, “measurements not
collected”, “sample taken at”, “depth too great”, “can’t get true
bottom”, “seen on bottom: no”, “bottom reading not taken”, “afraid to
touch bottom”, “forgot bottom reading”, “didn’t hit bottom”, “did not
hit bottom”, “vegetation blocks”, “turbid”, “probe not on bottom”,
“sonde.<em>not.</em>bottom”, “hydrolab not on bottom”, “profile not taken to
bottom”, “unable to collect bottom”, “bottom.<em>not.</em>collected”,
“bottom.<em>not.</em>recorded”. The strings listed here include the regex
symbols of “.” for a single-character wildcard and “.*” for a greedy
wildcard of any character length.</p>
<p>After this, we flagged these records with the <code>approx_flag</code>, indicating
the source of the gap filled values:</p>
<ul>
<li><code>0</code>: Value and units not adjusted (original <code>harmonized_value</code> is not
<code>NA</code>)</li>
<li><code>1</code>: <code>harmonized_value</code> filled using <code>ActivityDepthHeightMeasure</code>
column</li>
<li><code>2</code>: <code>harmonized_value</code> filled using
<code>ActivityBottomDepthHeightMeasure</code> column</li>
</ul>
<p>This should not result in a change in rows but we still check: 0
thousand rows are removed and 3.1 million rows remain.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-20-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="drop-unresolved-na-measurements-2" class="section level3 hasAnchor" number="7.2.7">
<h3><span class="header-section-number">7.2.7</span> Drop unresolved NA measurements<a href="secchi-harmonization-process.html#drop-unresolved-na-measurements-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The goal of the preceding three steps was to prevent records with
seemingly missing measurement data from being dropped if there was still
a chance of recovering a usable value. At this point we’ve finished with
that process and we proceed to check for remaining records with <code>NA</code>
values in their <code>harmonized_value</code> column. If they exist, they are
dropped.</p>
<p>51.7 thousand rows are removed. The final row count after this is 3
million.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-22-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="harmonize-record-units-2" class="section level3 hasAnchor" number="7.2.8">
<h3><span class="header-section-number">7.2.8</span> Harmonize record units<a href="secchi-harmonization-process.html#harmonize-record-units-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The next step in SDD harmonization is converting the units of WQP
records. We create the following conversion table, which is used to
translate units provided in WQP into meters (m):</p>
<table class=" lightable-paper table" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
harmonized_units
</th>
<th style="text-align:right;">
conversion
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
m
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
ft
</td>
<td style="text-align:right;">
0.3048
</td>
</tr>
<tr>
<td style="text-align:left;">
cm
</td>
<td style="text-align:right;">
0.0100
</td>
</tr>
<tr>
<td style="text-align:left;">
in
</td>
<td style="text-align:right;">
0.0254
</td>
</tr>
<tr>
<td style="text-align:left;">
mm
</td>
<td style="text-align:right;">
0.0010
</td>
</tr>
<tr>
<td style="text-align:left;">
feet
</td>
<td style="text-align:right;">
0.3048
</td>
</tr>
<tr>
<td style="text-align:left;">
meters
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
mi
</td>
<td style="text-align:right;">
1609.3400
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Below is a pie chart that breaks down the different unit codes that were
dropped in the unit harmonization process, and how many records were
lost with each code.</p>
<p><br></p>
<p><img src="3_harmonize/out/sdd_unit_drop_pie.png" alt="ResultMeasure.MeasureUnitCode mismatched codes" width="650"/></p>
<p><br></p>
<p>Additionally we provide a set of histograms of harmonized measurements
by <code>CharacteristicName</code>:</p>
<p><br></p>
<p><img src="3_harmonize/out/sdd_charname_dists.png" alt="Distribution of SDD values by CharacteristicName" width="650"/></p>
<p><br></p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-25-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="clean-and-flag-bottom-depth-data" class="section level3 hasAnchor" number="7.2.9">
<h3><span class="header-section-number">7.2.9</span> Clean and flag bottom depth data<a href="secchi-harmonization-process.html#clean-and-flag-bottom-depth-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The next harmonization step involved gap filling the
<code>ActivityBottomDepthHeightMeasure.MeasureValue</code> and
<code>ActivityBottomDepthHeightMeasure.MeasureUnitCode</code> columns.</p>
<p>There are four columns that explicitly contain depth information for a
given WQP entry. Of these columns we are only interested in the
<code>ActivityBottomDepthHeightMeasure.MeasureValue</code> column for Secchi disk
depth because it may be an indicator of the bottom of the water body for
a given WQP entry. Here we harmonize the values in the bottom depth
column. To keep this data in line with the rest of the data in AquaSat
v2, the other harmonized depth columns are filled with <code>NA</code> since Secchi
disk depth is a discrete depth measurement. Those harmonized depth
columns are:</p>
<ul>
<li><code>harmonized_top_depth_value</code></li>
<li><code>harmonized_top_depth_unit</code></li>
<li><code>harmonized_discrete_depth_value</code></li>
<li><code>harmonized_discrete_depth_unit</code></li>
</ul>
<p>In order to gap fill bottom depths we searched for records with
previously identified bottom-related language and no information in the
bottom depth value and unit columns. These entries were flagged using
the <code>depth_flag</code> column, where <code>0</code> = bottom depth value not adjusted and
no indication that Secchi disk hit bottom, and <code>1</code> = bottom depth value
back filled with <code>harmonized_value</code> due to indication that Secchi disk
hit bottom.</p>
<p>If an entry was flagged, then the <code>harmonized_bottom_depth_value</code> column
was filled using the <code>harmonized_value</code> and the
<code>harmonized_bottom_depth_unit</code> column was filled using the
<code>harmonized_units</code> column. Finally, the units for the harmonized bottom
depth values were converted to meters (m).</p>
<p>This should not result in a change in rows but we still check: 0
thousand rows are removed and 3 million rows remain.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-27-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="filter-methods" class="section level3 hasAnchor" number="7.2.10">
<h3><span class="header-section-number">7.2.10</span> Filter methods<a href="secchi-harmonization-process.html#filter-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After cleaning and standardizing the Secchi bottom depth measurements,
we proceed to filter the analytical methods used.</p>
<p>We check the <code>ResultAnalyticalMethod.MethodName</code> column for names that
indicate non-Secchi disk depth measurements. Phrases used to flag and
remove unrelated methods for Secchi disk depth data are: “10200G”,
“2320”, “2540”, “2550”, “alkalin”, “calculation”, “chemical”,
“chlorophyll”, “coliform”, “conductance”, “laboratory calculation”,
“meteorological”, “nephelometry”, “nitrate”, “no information exists for
method”, “not available”, “other or unknown procedure”, “qa”,
“temperature”, “total suspended solids”, “unknown”, “unkown”,
“unspecified”.</p>
<p>This process drops 11.6 thousand rows leaving 3 million remaining.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-29-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="tier-methods" class="section level3 hasAnchor" number="7.2.11">
<h3><span class="header-section-number">7.2.11</span> Tier methods<a href="secchi-harmonization-process.html#tier-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We then tiered the data using information on the time of day of the
measurement, whether a viewscope was used, and whether the
<code>harmonized_value</code> was gap filled.</p>
<p>Our tiers were informed by Davies-Colley et al. (1993). Specifically,
10am-2pm represents the ideal time range for measurements due to
consistent lighting conditions and use of a viewscope can significantly
improve measurement accuracy by reducing surface glare and wave effects.
These considerations help assess the quality and reliability of the
Secchi disk depth data across different measurement conditions.</p>
<p>We tiered the data as follows:</p>
<!-- Table created with https://www.tablesgenerator.com/markdown_tables -->
<table>
<colgroup>
<col width="3%" />
<col width="4%" />
<col width="49%" />
<col width="42%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Tier</strong></th>
<th><strong>Name</strong></th>
<th><strong>Description</strong></th>
<th><strong>SDD details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>Restrictive</td>
<td>Data that are verifiably self-similar across organizations and time-periods and can be considered highly reliable and interoperable</td>
<td>Time was reported between 10am-2pm and was not 11:59:59. Method indicates use of viewscope</td>
</tr>
<tr class="even">
<td>1</td>
<td>Narrowed</td>
<td>Data that we have good reason to believe are self-similar, but for which we can’t verify full interoperability across data providers</td>
<td>Either time reported was between 10am-2pm and was no 11:59:59, OR method indicates use of viewscope, but not both</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Inclusive</td>
<td>Data that are assumed to be reliable and are harmonized to our best ability given the information available from the data provider.</td>
<td>Time not reported/was outside of 10am-2pm/was 11:59:59 and no indication that viewscope was used</td>
</tr>
<tr class="even">
<td>3</td>
<td>Inclusive</td>
<td>Same as above</td>
<td>Data where the <code>harmonized_value</code> is gap filled from other columns in the record</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>This should not result in a change in rows but we still check: 0 rows
are removed and 3 million rows remain.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-31-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="flag" class="section level3 hasAnchor" number="7.2.12">
<h3><span class="header-section-number">7.2.12</span> Flag<a href="secchi-harmonization-process.html#flag" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After cleaning and tiering the Secchi data, we conduct a final flagging
sweep. This process creates several flags to provide additional context
and quality indicators for each measurement.</p>
<p>We create four types of flags:</p>
<ol style="list-style-type: decimal">
<li><p><code>mdl_flag</code>: This flag indicates whether the value was corrected 1)
because original WQP record contained a “&lt;” character or, 2)
because the original value was less than 0.01m.</p>
<ul>
<li><code>flag 0</code>: Value greater than 0.01m with NO <code>&lt;</code> character in
original entry</li>
<li><code>flag 1</code>: Value greater than 0.01m with <code>&lt;</code> character in original
entry</li>
<li><code>flag 2</code>: Value less than or equal to 0.01m with NO <code>&lt;</code> character
in original entry; final value adjusted to to 0.01m</li>
<li><code>flag 3</code>: Value less than or equal to 0.01m with <code>&lt;</code> character in
original entry; final value adjusted to 0.01m</li>
</ul></li>
</ol>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li><p><code>greater_flag</code>: This flag indicates 1) whether the value was
corrected because the original WQP record contained a “&gt;” character
and 2), whether the <code>harmonized_value</code> is greater than 44m (Larson,
1972). Depths greater than 44m are flagged as potentially anomalous.</p>
<ul>
<li><code>flag 0</code>: Value less than 44m with NO <code>&gt;</code> character</li>
<li><code>flag 1</code>: Value less than 44m with <code>&gt;</code> character</li>
<li><code>flag 2</code>: Value greater than 44m with NO <code>&gt;</code> character</li>
<li><code>flag 3</code>: Value greater than 44m with <code>&gt;</code> character</li>
</ul></li>
</ol>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li><p><code>field_flag</code>: Indicates whether the <code>ActivityCommentText</code> or
<code>ResultCommentText</code> columns contained language indicating
environmental conditions, i.e.: “wind”, “chop”, “choppy”,
“precipitation”, “rain”, “calm”, or “clear”.</p>
<ul>
<li><code>flag 0</code>: Environmental indicator present in comment</li>
<li><code>flag 1</code>: No environmental indicator present in comments</li>
</ul></li>
</ol>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li><p><code>misc_flag</code>: The miscellaneous flag captures various other
conditions that might affect data quality or interpretation.</p>
<ul>
<li><code>flag 0</code>: No miscellaneous condition flagged</li>
<li><code>flag 1</code>: Bottom of water body indicated</li>
<li><code>flag 2</code>: Harmonized value is greater than the bottom depth value</li>
<li><code>flag 3</code>: Special characters removed (-,=.*)</li>
</ul></li>
</ol>
<p>This should not result in a change in rows but we still check: 0 rows
are removed and 3 million rows remain.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-33-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="remove-unrealistic-values-1" class="section level3 hasAnchor" number="7.2.13">
<h3><span class="header-section-number">7.2.13</span> Remove unrealistic values<a href="secchi-harmonization-process.html#remove-unrealistic-values-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before finalizing the dataset we removed Secchi disk depth values that
were beyond a realistic threshold because they were likely erroneous. We
used 80m as our cutoff for removal based on Gieskes et al. (1987).</p>
<p>Additionally, we convert values less than 0.01m to 0.01m based on
observed Secchi disk depth records (NALMS, 2024).</p>
<p>These changes improve the overall reliability of the dataset by
minimizing the amount of data with potential inaccuracies and preserving
measurements that correctly describe the aquatic environment.</p>
<p>This process drops 1819 rows leaving 3 million remaining.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-35-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="aggregate-simultaneous-records-2" class="section level3 hasAnchor" number="7.2.14">
<h3><span class="header-section-number">7.2.14</span> Aggregate simultaneous records<a href="secchi-harmonization-process.html#aggregate-simultaneous-records-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The final step of Secchi disk depth harmonization is to aggregate
simultaneous observations. Any group of samples determined to be
simultaneous are simplified into a single record containing the mean and
coefficient of variation (CV) of the group. These can be either true
duplicate entries in the Water Quality Portal (WQP) or records with
non-identical values recorded at the same time and place and by the same
organization (field and/or lab replicates/duplicates). The CV can be
used to filter the dataset based on the amount of variability that is
tolerable to specific use cases. Note, however, that many entries will
have a CV that is <code>NA</code> because there are no duplicates or 0 because the
records are duplicates and all entries have the same <code>harmonized_value</code>.</p>
<p>We identify simultaneous records to aggregate by creating identical
subgroups (<code>subgroup_id</code>) from the following columns: <code>parameter</code>,
<code>OrganizationIdentifier</code>, <code>MonitoringLocationIdentifier</code>,
<code>MonitoringLocationTypeName</code>, <code>ResolvedMonitoringLocationTypeName</code>,
<code>ActivityStartDate</code>, <code>ActivityStartTime.Time</code>,
<code>ActivityStartTime.TimeZoneCode</code>, <code>harmonized_tz</code>,
<code>harmonized_local_time</code>, <code>harmonized_utc</code>, <code>ActivityStartDateTime</code>,
<code>harmonized_top_depth_value</code>, <code>harmonized_top_depth_unit</code>,
<code>harmonized_bottom_depth_value</code>, <code>harmonized_bottom_depth_unit</code>,
<code>harmonized_discrete_depth_value</code>, <code>harmonized_discrete_depth_unit</code>,
<code>depth_flag</code>, <code>mdl_flag</code>, <code>approx_flag</code>, <code>greater_flag</code>, <code>tier</code>,
<code>field_flag</code>, <code>misc_flag</code>, <code>harmonized_units</code>. This selection limits the
columns included in the final dataset, but we also provide a copy of the
dataset prior to its aggregation (pipeline target
<code>p3_sdd_preagg_grouped</code>), and including the <code>subgroup_id</code> column, so
that users can use the non-aggregated data as well and make joins
between dataset versions.</p>
<p>The final, aggregated values are presented in the <code>harmonized_value</code> and
<code>harmonized_value_cv</code> columns. The number of rows used per group is
recorded in the <code>harmonized_row_count</code> column.</p>
<p>0.3 million rows dropped leaving 2.7 million remaining in the final
harmonized and aggregated Secchi disk depth dataset.</p>
<p><img src="chapters/05_sdd_harmonization_files/figure-gfm/unnamed-chunk-37-1.png" /><!-- --></p>
<p><br></p>
</div>
<div id="harmonized-secchi-disk-depth" class="section level3 hasAnchor" number="7.2.15">
<h3><span class="header-section-number">7.2.15</span> Harmonized Secchi disk depth<a href="secchi-harmonization-process.html#harmonized-secchi-disk-depth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At this point the harmonization of the Secchi disk depth data from the
WQP is complete and we export the final dataset for use later in the
workflow.</p>
<p>Below is a final set of histograms showing the distribution of
harmonized measurements (top) and CVs (bottom) broken down by <code>tier</code>
<strong><em>after</em></strong> aggregating simultaneous records.</p>
<p><br></p>
<p><img src="3_harmonize/out/sdd_tier_dists_postagg.png" alt="Distribution of SDD values by tier" width="650"/></p>
<p><img src="3_harmonize/out/sdd_tier_cv_dists_postagg.png" alt="Distribution of SDD CVs by tier" width="650"/></p>
<p><br></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="doc-harmonization-process.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="notes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
